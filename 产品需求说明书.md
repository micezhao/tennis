# 网球爱好者社区应用 - 产品需求说明书

## 1. 产品概述

### 1.1 产品定位
本产品是一款运行在微信小程序环境中的网球主题爱好者社区应用，旨在解决网球场地信息获取难、约球匹配难等痛点，构建连接球场设施供给侧与网球消费者需求侧的桥梁，提供高效的约球匹配与撮合机制。

### 1.2 核心价值
- **信息整合**：聚合分散的球场信息，提供准确、实时的场地数据
- **高效匹配**：基于位置、时间、水平、价格四要素，实现约球信息的精准匹配
- **透明交易**：明确约球规则、费用分摊，减少沟通成本
- **社区生态**：构建网球爱好者社区，促进交流与互动

### 1.3 目标用户
- 网球爱好者（从新手到专业玩家）
- 球场运营方

## 2. 业务功能

### 2.1 球场信息服务

#### 2.1.1 球场搜索与列表
- 支持关键字搜索球场名称、地址
- 提供列表视图和地图视图切换
- 支持多维度筛选：距离、场地类型（硬地/红土/草地）、室内/室外、价格范围、是否有灯光
- 支持排序：距离、评分、价格
- 显示球场基本信息：名称、距离、评分、价格、场地类型、开放状态

#### 2.1.2 球场详情
- 球场基本信息展示：名称、地址、联系方式、营业时间
- 场地设施信息：场地数量、类型、是否有灯光、配套设施（淋浴、停车场、pro shop等）
- 实时可用时段展示与预约
- 用户评价与评分
- 位置导航

#### 2.1.3 球场预约
- 选择日期和时段
- 选择场地类型
- 显示实时价格
- 提交预约申请

### 2.2 约球服务

#### 2.2.1 约球信息发布
- 选择球场
- 设置日期和时段
- 选择约球模式：单打/双打/练球
- 设置水平要求（NTRP等级）
- 设置招募人数
- 费用分摊方式：AA制/群主请客/定额
- 填写备注信息

#### 2.2.2 约球列表
- 展示附近约球活动
- 支持筛选：区域、水平、日期、距离
- 支持排序：推荐、距离、时间、参与人数
- 显示约球活动基本信息：标题、水平要求、剩余名额、时间、地点、距离、费用

#### 2.2.3 约球报名
- 查看约球详情：时间、地点、水平要求、费用、组织者信息
- 上传球技视频（可选）
- 留言给组织者（可选）
- 确认报名并支付

#### 2.2.4 约球管理
- 组织者可查看报名列表
- 组织者可审核报名请求
- 参与者可查看已报名活动
- 支持取消报名

### 2.3 用户管理

#### 2.3.1 微信登录与认证流程
1. 用户通过微信小程序发起登录请求
2. 小程序调用微信API获取临时登录凭证code
3. 小程序将code发送到后端登录接口
4. 后端使用code调用微信开放平台API获取openid和session_key
5. 后端根据openid查询用户是否已存在
   - 若不存在：创建新用户，生成用户ID
   - 若存在：获取现有用户ID
6. 后端使用Spring Security生成认证对象，存储用户信息
7. 后端将认证结果返回给小程序
8. 小程序保存登录状态，后续请求携带认证信息

#### 2.3.2 个人资料
- 基本信息：昵称、头像、性别、年龄
- 网球水平：NTRP等级认证
- 球龄、常用场地
- 个人简介

#### 2.3.3 技能评估与历史
- 记录比赛历史
- 技能评估数据
- 成长曲线

### 2.4 支付与订单

#### 2.4.1 支付功能
- 支持微信支付
- 费用透明，提前知晓

#### 2.4.2 订单管理
- 查看历史订单
- 订单详情
- 取消订单

## 3. 业务约束规则

### 3.1 球场预约规则
- 预约需提前至少1小时
- 预约成功后，如需取消需提前2小时
- 每个用户同一天同一球场最多预约2小时

### 3.2 约球规则
- 约球发布者需实名认证
- 参与者需满足发布者设置的水平要求
- 约球活动开始前24小时可取消报名，逾期不可取消
- 发布者可设置审核机制，审核通过后参与者方可加入

### 3.3 支付规则
- 约球报名需先支付费用
- 活动取消时，费用按规则退还：
  - 活动开始前24小时取消：全额退还
  - 活动开始前24小时内取消：退还50%
  - 活动开始后取消：不退还

### 3.4 信用规则
- 建立用户信用评分体系
- 恶意爽约、虚假信息发布将降低信用分
- 信用分过低将限制发布约球和报名功能

## 4. 交互流程

### 4.1 球场预约流程
1. 用户进入球场列表页
2. 搜索或筛选目标球场
3. 查看球场详情，选择日期和时段
4. 确认预约信息，提交预约
5. 支付预约费用
6. 预约成功，收到确认信息

### 4.2 发布约球流程
1. 用户点击"发布约球"按钮
2. 选择球场
3. 设置日期和时段
4. 选择约球模式和水平要求
5. 设置招募人数和费用分摊方式
6. 填写备注信息
7. 确认发布
8. 约球信息发布成功

### 4.3 约球报名流程
1. 用户浏览约球列表
2. 选择感兴趣的约球活动
3. 查看活动详情
4. 点击"报名"按钮
5. 上传球技视频（可选）
6. 填写留言（可选）
7. 确认报名信息，支付费用
8. 等待组织者审核（如需）
9. 报名成功，加入约球群组

### 4.4 约球管理流程
1. 组织者进入"我的约球"页面
2. 查看待审核报名列表
3. 审核报名请求（通过/拒绝）
4. 活动开始前发送提醒
5. 活动结束后可评价参与者

## 5. 前端对后端接口要求

### 5.1 接口设计原则
- 采用RESTful API设计风格
- 所有接口返回JSON格式数据
- 接口需包含统一的错误处理机制
- 敏感接口需进行身份验证
- 支持分页查询

### 5.2 具体接口需求

#### 5.2.1 用户模块

| 接口名称 | 方法 | URL | 功能描述 | 请求参数 | 返回参数 |
|---------|------|-----|---------|---------|---------|
| 用户登录 | POST | /api/user/login | 微信登录 | code: string | token: string, userInfo: object |
| 获取用户信息 | GET | /api/user/info | 获取当前用户信息 | - | userInfo: object |
| 更新用户信息 | PUT | /api/user/info | 更新用户信息 | nickName: string, avatarUrl: string, gender: number, age: number, level: string, bio: string | success: boolean |
| 获取技能评估历史 | GET | /api/user/skill-history | 获取用户技能评估历史 | page: number, pageSize: number | list: array, total: number |

#### 5.2.2 球场模块

| 接口名称 | 方法 | URL | 功能描述 | 请求参数 | 返回参数 |
|---------|------|-----|---------|---------|---------|
| 球场列表 | GET | /api/court/list | 获取球场列表 | keyword: string, latitude: number, longitude: number, distance: number, surfaceType: string, indoor: boolean, priceMin: number, priceMax: number, hasLights: boolean, sortBy: string, page: number, pageSize: number | list: array, total: number |
| 球场详情 | GET | /api/court/:id | 获取球场详情 | id: string | courtInfo: object |
| 获取可用时段 | GET | /api/court/:id/available-slots | 获取球场可用时段 | id: string, date: string | slots: array |
| 预约球场 | POST | /api/court/:id/book | 预约球场 | id: string, date: string, startTime: string, endTime: string, surfaceType: string | orderId: string |
| 获取球场评价 | GET | /api/court/:id/reviews | 获取球场评价 | id: string, page: number, pageSize: number | list: array, total: number |

#### 5.2.3 约球模块

| 接口名称 | 方法 | URL | 功能描述 | 请求参数 | 返回参数 |
|---------|------|-----|---------|---------|---------|
| 发布约球 | POST | /api/match/publish | 发布约球信息 | courtId: string, date: string, startTime: string, endTime: string, matchType: string, levelMin: number, levelMax: number, maxPlayers: number, costType: string, costPerPerson: number, description: string | matchId: string |
| 约球列表 | GET | /api/match/list | 获取约球列表 | keyword: string, latitude: number, longitude: number, distance: number, levelMin: number, levelMax: number, date: string, sortBy: string, page: number, pageSize: number | list: array, total: number |
| 约球详情 | GET | /api/match/:id | 获取约球详情 | id: string | matchInfo: object |
| 报名约球 | POST | /api/match/:id/join | 报名约球 | id: string, videoUrl: string, message: string | orderId: string |
| 取消报名 | POST | /api/match/:id/cancel | 取消约球报名 | id: string | success: boolean |
| 我的约球 | GET | /api/match/my | 获取我发布的约球 | status: string, page: number, pageSize: number | list: array, total: number |
| 我报名的约球 | GET | /api/match/joined | 获取我报名的约球 | status: string, page: number, pageSize: number | list: array, total: number |
| 审核报名 | POST | /api/match/:id/approve | 审核约球报名 | id: string, userId: string, approved: boolean | success: boolean |

#### 5.2.4 订单模块

| 接口名称 | 方法 | URL | 功能描述 | 请求参数 | 返回参数 |
|---------|------|-----|---------|---------|---------|
| 创建订单 | POST | /api/order/create | 创建订单 | type: string, targetId: string, amount: number | orderId: string, paymentParams: object |
| 订单列表 | GET | /api/order/list | 获取订单列表 | status: string, page: number, pageSize: number | list: array, total: number |
| 订单详情 | GET | /api/order/:id | 获取订单详情 | id: string | orderInfo: object |
| 取消订单 | POST | /api/order/:id/cancel | 取消订单 | id: string | success: boolean |
| 支付回调 | POST | /api/order/pay-callback | 微信支付回调 | 微信支付回调参数 | success: boolean |

#### 5.2.5 评价模块

| 接口名称 | 方法 | URL | 功能描述 | 请求参数 | 返回参数 |
|---------|------|-----|---------|---------|---------|
| 提交评价 | POST | /api/comment/submit | 提交评价 | targetId: string, targetType: string, rating: number, content: string | success: boolean |
| 获取评价 | GET | /api/comment/list | 获取评价列表 | targetId: string, targetType: string, page: number, pageSize: number | list: array, total: number |

### 5.3 数据结构定义

#### 5.3.1 用户信息
```json
{
  "userId": "string",
  "nickName": "string",
  "avatarUrl": "string",
  "gender": 0,
  "age": 0,
  "level": "string",
  "bio": "string",
  "creditScore": 0,
  "createdAt": "string"
}
```

#### 5.3.2 球场信息
```json
{
  "courtId": "string",
  "name": "string",
  "address": "string",
  "latitude": 0,
  "longitude": 0,
  "phone": "string",
  "businessHours": "string",
  "rating": 0,
  "reviewCount": 0,
  "pricePerHour": 0,
  "surfaceType": "string",
  "indoor": false,
  "hasLights": false,
  "amenities": ["string"],
  "available": true
}
```

#### 5.3.3 约球信息
```json
{
  "matchId": "string",
  "publisherId": "string",
  "courtId": "string",
  "courtName": "string",
  "date": "string",
  "startTime": "string",
  "endTime": "string",
  "matchType": "string",
  "levelMin": 0,
  "levelMax": 0,
  "currentPlayers": 0,
  "maxPlayers": 0,
  "costType": "string",
  "costPerPerson": 0,
  "description": "string",
  "status": "string",
  "createdAt": "string",
  "distance": 0
}
```

#### 5.3.4 订单信息
```json
{
  "orderId": "string",
  "userId": "string",
  "type": "string",
  "targetId": "string",
  "amount": 0,
  "status": "string",
  "createdAt": "string",
  "paidAt": "string",
  "canceledAt": "string"
}
```

#### 5.3.5 评价信息
```json
{
  "commentId": "string",
  "userId": "string",
  "userName": "string",
  "userAvatar": "string",
  "targetId": "string",
  "targetType": "string",
  "rating": 0,
  "content": "string",
  "createdAt": "string"
}
```

## 6. 技术栈要求

### 6.1 前端技术栈
- 微信小程序原生开发
- WXML + WXSS + JavaScript
- 支持组件化开发

### 6.2 后端技术栈
- 建议使用Node.js + Express或Python + Django/Flask
- 数据库建议使用MongoDB或MySQL
- 支持微信支付集成
- 支持地理位置服务

## 7. 后续迭代计划

1. **v1.0**：核心功能实现（球场搜索、预约、约球发布、报名）
2. **v1.1**：添加用户评价体系、信用评分系统
3. **v1.2**：实现球技视频上传与自动评估功能
4. **v1.3**：添加球场运营方管理后台
5. **v1.4**：实现赛事报名与管理功能
6. **v1.5**：添加网球教学内容与教练预约功能

## 8. 风险评估

1. **数据准确性风险**：需建立可靠的球场信息来源和更新机制
2. **用户活跃度风险**：需通过运营手段提高用户粘性和活跃度
3. **支付安全风险**：需严格遵守微信支付安全规范
4. **隐私保护风险**：需建立完善的用户隐私保护机制
5. **竞争风险**：需持续优化产品体验，保持竞争力

## 9. 运营建议

1. 初期可与本地知名球场合作，确保信息准确性
2. 开展线上线下活动，提高用户活跃度
3. 建立完善的用户反馈机制，持续优化产品
4. 加强社区运营，促进用户交流与互动
5. 定期举办约球活动，提高平台影响力

---

**文档版本**：v1.0
**编制日期**：2025-12-30
**编制人**：AI Assistant
**审核人**：待定